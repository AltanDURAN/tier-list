{% extends 'base.html.twig' %}

{% block body %}
<div class="container mx-auto p-4">
    <h1 class="text-2xl font-bold mb-4">Édition de la Tier List : {{ tierList.name }}</h1>

    <div class="grid gap-4">
        {% for tier in tierList.tiers %}
        <div class="tier p-4 border rounded bg-gray-50" data-tier-id="{{ tier.id }}">
            <h2 class="font-semibold mb-2">{{ tier.name }}</h2>
            <div class="tier-items grid gap-2" x-data x-init="
                Sortable.create($el, {
                    group: 'tiers',
                    animation: 150,
                    onEnd: function(evt) {
                        console.log('Item déplacé', evt.item.dataset.itemId, 'dans tier', evt.to.dataset.tierId)
                        // Ici tu peux envoyer un fetch/Ajax pour mettre à jour la position
                    }
                });
            ">
                {% for item in tier.tierItems %}
                <div class="tier-item p-2 bg-white border rounded flex items-center gap-2" data-item-id="{{ item.id }}">
                    <img src="{{ asset('uploads/' ~ item.image) }}" alt="{{ item.name }}" class="w-10 h-10 object-cover rounded">
                    <span>{{ item.name }}</span>
                </div>
                {% endfor %}
            </div>
        </div>
        {% endfor %}
    </div>

    <h2 class="mt-6 font-semibold">Non classés</h2>
    <div class="tier-items grid gap-2 p-2 border rounded bg-gray-100" x-data x-init="
        Sortable.create($el, {
            group: 'tiers',
            animation: 150,
            onEnd: function(evt) {
                console.log('Item déplacé dans non classés', evt.item.dataset.itemId)
                // Ici fetch/Ajax pour mettre tier_id=null
            }
        });
    ">
        {% for item in tierList.items %}
            {% if item.tier is null %}
                <div class="tier-item p-2 bg-white border rounded flex items-center gap-2" data-item-id="{{ item.id }}">
                    <img src="{{ asset('uploads/' ~ item.image) }}" alt="{{ item.name }}" class="w-10 h-10 object-cover rounded">
                    <span>{{ item.name }}</span>
                </div>
            {% endif %}
        {% endfor %}
    </div>
</div>
{% endblock %}
